{"version":3,"file":"index.umd.js","sources":["../src/array.js","../src/defined.js","../src/interval.js","../src/betweener.js","../src/buildEnum.js","../src/capitalize.js","../src/mapo.js","../src/charkeys.js","../src/clipper.js","../src/flattener.js","../src/hasAllKeys.js","../src/hasAllCharkeys.js","../src/indexer.js","../src/indexById.js","../src/isFunction.js","../src/mapp.js","../src/nonempty.js","../src/now.js","../src/omitter.js","../src/randomInt.js","../src/rounder.js","../src/singleton.js","../src/sleep.js","../src/upto.js","../src/index.js"],"sourcesContent":["//import isFunction from './isFunction';\n\nexport default function array (...args) {\n  let a;\n  if (args.length > 1) {\n    a = args;\n  } else {\n    const value = args[0];\n    if (Array.isArray(value)) {\n      a = value;\n    } else if ([null, undefined].includes(value)) {\n      a = [];\n    } else {\n      a = [value];\n    }\n  }\n\n  let compare = null;\n  function setCompare (c) {\n    compare = c;\n  }\n\n  function _index (item) {\n    if (compare) {\n      return a.findIndex(compare);\n    } else {\n      return a.indexOf(item);\n    }\n  }\n\n  function _split ({index, item, dir}) {\n    if (!index) {\n      index = _index(item);\n    }\n    let before = a.slice(0, index);\n    let after = a.slice(index + 1);\n\n    const point = a[index];\n    let split = [];\n    if (dir === 0) {\n      split = [point];\n    } else if (dir === -1) {\n      before = [...before, point];\n    } else if (dir === 1) {\n      after = [point, ...after];\n    }\n    return [before, ...split, after];\n  }\n\n  function splitLeft (args) {\n    return _split({...args, dir: -1});\n  }\n\n  function splitWith (args) {\n    return _split({...args, dir: 0});\n  }\n\n  function split (args) {\n    const [before, _, after] = _split({...args, dir: 0});\n    return [before, after];\n  }\n\n  function splitRight (args) {\n    return _split({...args, dir: 1});\n  }\n\n  function remove ({index, item}) {\n    if (!index) {\n      index = _index(item);\n    }\n    const [before, after] = split(index);\n    return [...before, ...after];\n  }\n\n  function inserter ({index, item}) {\n    if (!index) {\n      index = _index(item);\n    }\n    return function insert (item) {\n      const [before, after] = split(index);\n      return [...before, item, ...after];\n    };\n  }\n\n  function empty () {\n    return (a.length === 0);\n  }\n\n  Object.defineProperties(a, {\n    splitLeft: {\n      value: splitLeft\n    },\n    split: {\n      value: split\n    },\n    splitWith: {\n      value: splitWith\n    },\n    splitRight: {\n      value: splitRight\n    },\n    remove: {\n      value: remove\n    },\n    inserter: {\n      value: inserter\n    },\n    compare: {\n      value: setCompare\n    },\n    empty: {\n      value: empty\n    }\n  });\n\n  return a;\n}\n","export default function defined (val) {\n  return (typeof val !== 'undefined');\n}\n","import defined from './defined';\n\nconst interval_regex = /(?<left>[[(])\\s*(?<left_num>[+-]?([0-9]+([.][0-9]*)?|([.][0-9]+)|∞))\\s*,\\s*(?<right_num>[+-]?([0-9]+([.][0-9]*)?|([.][0-9]+)|∞))\\s*(?<right>[)\\]])/;\n\nexport default function interval (arg) {\n  if (arg.constructor === String) {\n    const match = arg.match(interval_regex);\n    if (!match) {\n      throw new Error('Invalid interval string');\n    }\n\n    const {left, left_num, right_num, right} = match.groups;\n    const map = {\n      '[': 'gte',\n      '(': 'gt',\n      ')': 'lt',\n      ']': 'lte'\n    };\n\n    const bounds = [left_num, right_num].map((num)=> {\n      if (num === '-∞') {\n        return -Infinity;\n      } else if (num === '∞') {\n        return Infinity;\n      } else {\n        return parseFloat(num);\n      }\n    });\n\n    arg = {\n      [map[left]]: bounds[0],\n      [map[right]]: bounds[1]\n    };\n  }\n\n  if (Array.isArray(arg)) {\n    const [min, max] = arg;\n    arg = {\n      gte: min,\n      lte: max\n    };\n  }\n\n  const has_gt = defined(arg.gt);\n  const has_gte = defined(arg.gte);\n  const has_lt = defined(arg.lt);\n  const has_lte = defined(arg.lte);\n\n  const has_both_g = (has_gt && has_gte);\n  const has_both_l = (has_lt && has_lte);\n  const has_one = (has_gt || has_gte || has_lt || has_lte);\n\n  if (has_both_g || has_both_l || !has_one) {\n    throw new Error('Invalid interval');\n  }\n\n  return arg;\n}\n","import interval from './interval';\nimport defined from './defined';\n\nexport default function betweener (arg) {\n  const {lt, lte, gt, gte} = interval(arg);\n\n  return function between (value) {\n    if (defined(gt) && (value <= gt)) {\n      return false;\n    }\n    if (defined(gte) && (value < gte)) {\n      return false;\n    }\n    if (defined(lt) && (value >= lt)) {\n      return false;\n    }\n    if (defined(lte) && (value > lte)) {\n      return false;\n    }\n    return true;\n  };\n}\n","export default function buildEnum (types) {\n  return types.reduce((Types, type)=> {\n    Types[type] = type;\n    return Types;\n  }, {});\n}\n","export default function capitalize (string) {\n  const first = string.charAt(0).toUpperCase();\n  const rest = string.slice(1);\n  return `${first}${rest}`;\n}\n","export default function mapo ({\n  key: mapkey,\n  value: mapval\n}) {\n  return function map (obj) {\n    const entries = Object.entries(obj);\n    const mapped = entries.map(([key, value])=> {\n      if (mapkey) {\n        key = mapkey({key, value});\n      }\n      if (mapval) {\n        value = mapval({key, value});\n      }\n      return [key, value];\n    });\n    return Object.fromEntries(mapped);\n  };\n}\n","import mapo from './mapo';\n\nconst charkeys = mapo({\n  key: ({key})=> key[0]\n});\n\nexport default charkeys;\n","import interval from './interval';\nimport defined from './defined';\n\nconst {MIN_VALUE} = Number;\n\nexport default function clipper (arg) {\n  const {lt, lte, gt, gte} = interval(arg);\n\n  return function constrain (value) {\n    if (defined(gt) && (value <= gt)) {\n      return gt + MIN_VALUE;\n    }\n    if (defined(gte) && (value < gte)) {\n      return gte;\n    }\n    if (defined(lt) && (value >= lt)) {\n      return lt - MIN_VALUE;\n    }\n    if (defined(lte) && (value > lte)) {\n      return lte;\n    }\n    return value;\n  };\n}\n","export default function flattener ({join = '.', into = {}} = {}) {\n  return function flatten (obj, key = null) {\n    if (obj && obj.constructor === Object) {\n      const entries = Object.entries(obj);\n      if (entries.length) {\n        for (const [k, v] of entries) {\n          const parts = key ? [key, k] : [k];\n          const new_key = parts.join(join);\n          flatten(v, new_key);\n        }\n      } else {\n        into[key] = {};\n      }\n    } else {\n      into[key] = obj;\n    }\n    return into;\n  };\n}\n","export default function hasAllKeys (keys) {\n  return function hasAll (obj) {\n    return keys.every((key)=> {\n      return Object.prototype.hasOwnProperty.call(obj, key);\n    });\n  };\n}\n","import charkeys from './charkeys';\nimport hasAllKeys from './hasAllKeys';\n\nexport default function hasAllCharkeys (keys) {\n  return function has (obj) {\n    obj = charkeys(obj);\n    return hasAllKeys(keys)(obj);\n  };\n}\n","import buildEnum from './buildEnum';\n\nconst types = buildEnum(['array', 'first', 'last']);\n\nexport default function indexer (arg) {\n  if (!arg) {\n    arg = {\n      attr: 'id',\n      type: types.first\n    };\n  }\n\n  if (arg.constructor === String) {\n    arg = {\n      attr: arg\n    };\n  }\n\n  const {\n    attr,\n    type = types.array\n  } = arg;\n\n  if (!(type in types)) {\n    throw new Error('Invalid index type');\n  }\n\n  return function index (items) {\n    const index = {};\n    for (const item of items) {\n      const value = item[attr];\n      const has_value = (value in index);\n      if (type === types.array) {\n        if (!has_value) {\n          index[value] = [];\n        }\n        index[value].push(item);\n      } else if (type === types.first) {\n        if (!has_value) {\n          index[value] = item;\n        }\n      } else {\n        index[value] = item;\n      }\n    }\n    return index;\n  };\n}\n\nfor (const [k, v] of Object.entries(types)) {\n  indexer[k] = v;\n}\n","import indexer from './indexer';\n\nconst indexById = indexer();\nexport default indexById;\n","export default function isFunction (fn) {\n  if (!fn) {\n    return false;\n  }\n  // TODO?? https://github.com/developit/microbundle/issues/721\n  //return ['Function', 'AsyncFunction'].includes(fn.constructor.name);\n  const AsyncFunction = (async ()=> { return null; }).constructor;\n  return [Function, AsyncFunction].includes(fn.constructor);\n}\n","export default async function mapp (iterable, map, options = {}) {\n  let concurrency = options.concurrency || Infinity;\n  let index = 0;\n  const results = [];\n  const runs = [];\n  const iterator = iterable[Symbol.iterator]();\n  const sentinel = Symbol('sentinel');\n\n  while (concurrency-- > 0) {\n    const r = run();\n    if (r === sentinel) {\n      break;\n    } else {\n      runs.push(r);\n    }\n  }\n\n  function run () {\n    const {done, value} = iterator.next();\n    if (done) {\n      return sentinel;\n    } else {\n      const i = index++;\n      const p = map(value, i);\n      return Promise.resolve(p)\n        .then((result)=> {\n          results[i] = result;\n          return run();\n        });\n    }\n  }\n\n  return Promise.all(runs).then(()=> results);\n}\n","export default function nonempty (value) {\n  if ((value === null) || (value === undefined)) {\n    return false;\n  }\n  if (value.length !== undefined) {\n    return (value.length > 0);\n  }\n  if (value.constructor === Object) {\n    const keys = Object.keys(value);\n    return (keys.length > 0);\n  }\n  return true;\n}\n","export default function now () {\n  return new Date();\n}\n","export default function omitter (keys) {\n  let test;\n  if (Array.isArray(keys)) {\n    test = (key)=> keys.includes(key);\n  } else {\n    test = keys;\n  }\n  return function omit (obj) {\n    return Object.entries(obj).reduce((result, [key, value])=> {\n      if (!test(key, value)) {\n        result[key] = obj[key];\n      }\n      return result;\n    }, {});\n  };\n}\n","const {isInteger} = Number;\n\nexport default function randomInt (arg = {}) {\n  if (Array.isArray(arg)) {\n    const [min, max] = arg;\n    arg = {min, max};\n  } else if (isInteger(arg)) {\n    arg = {\n      max: arg\n    };\n  }\n  const {min = 0, max = 1} = arg;\n\n  if (!isInteger(min) || !isInteger(max)) {\n    throw new Error('min and max must be integers');\n  }\n  if (max < min) {\n    throw new Error('min must be less than or equal to max');\n  }\n\n  const delta = max - min;\n  const offset = Math.floor(Math.random() * (delta + 1));\n  return min + offset;\n}\n","export default function rounder ({decimals = 0, op = Math.round} = {}) {\n  if (!(Number.isInteger(decimals) && (decimals >= 0))) {\n    throw new Error('Argument decimals must be non-negative integer');\n  }\n\n  if (!(op && (op.constructor === Function))) {\n    throw new Error('Argument op must be a function');\n  }\n\n  const multiplier = 10 ** decimals;\n  return function round (num) {\n    return op(num * multiplier) / multiplier;\n  };\n}\n","export default function singleton (args) {\n  if (args && (args.constructor === Function)) {\n    args = {\n      Class: args\n    };\n  }\n\n  if (!args || !args.Class) {\n    throw new Error('Must pass constructor or object with \"Class\" prop');\n  }\n\n  const {\n    Class,\n    instance = 'instance',\n    key = '_instance'\n  } = args;\n\n  Class[instance] = function instance (...args) {\n    if (!this[key]) {\n      this[key] = new this(...args);\n    }\n    return this[key];\n  };\n}\n","export default function sleep (time_ms) {\n  return new Promise((resolve)=> {\n    setTimeout(resolve, time_ms);\n  });\n}\n","/// iterable that returns array or function\n\nexport default function upto (n) {\n  let i = 0;\n  const results = [];\n  return function f (fn) {\n    while (i <= n) {\n      results.push(fn(i));\n      i++;\n    }\n    return results;\n  };\n}\n","console.log('hi microbundle', {\n  fn: (function () {}).constructor,\n  afn: (async function () { return Promise.resolve(); }).constructor\n});\n\nexport {default as array} from './array';\nexport {default as betweener} from './betweener';\nexport {default as buildEnum} from './buildEnum';\nexport {default as capitalize} from './capitalize';\nexport {default as charkeys} from './charkeys';\nexport {default as clipper} from './clipper';\nexport {default as defined} from './defined';\nexport {default as flattener} from './flattener';\nexport {default as hasAllCharkeys} from './hasAllCharkeys';\nexport {default as hasAllKeys} from './hasAllKeys';\nexport {default as indexById} from './indexById';\nexport {default as indexer} from './indexer';\nexport {default as interval} from './interval';\nexport {default as isFunction} from './isFunction';\nexport {default as mapo} from './mapo';\nexport {default as mapp} from './mapp';\nexport {default as nonempty} from './nonempty';\nexport {default as now} from './now';\nexport {default as omitter} from './omitter';\nexport {default as randomInt} from './randomInt';\nexport {default as rounder} from './rounder';\nexport {default as singleton} from './singleton';\nexport {default as sleep} from './sleep';\nexport {default as upto} from './upto';\n"],"names":["array","args","a","length","value","Array","isArray","undefined","includes","compare","setCompare","c","_index","item","findIndex","indexOf","_split","index","dir","before","slice","after","point","split","splitLeft","splitWith","_","splitRight","remove","inserter","insert","empty","Object","defineProperties","defined","val","interval_regex","interval","arg","constructor","String","match","Error","left","left_num","right_num","right","groups","map","bounds","num","Infinity","parseFloat","min","max","gte","lte","has_gt","gt","has_gte","has_lt","lt","has_lte","has_both_g","has_both_l","has_one","betweener","between","buildEnum","types","reduce","Types","type","capitalize","string","first","charAt","toUpperCase","rest","mapo","key","mapkey","mapval","obj","entries","mapped","fromEntries","charkeys","MIN_VALUE","Number","clipper","constrain","flattener","join","into","flatten","k","v","parts","new_key","hasAllKeys","keys","hasAll","every","prototype","hasOwnProperty","call","hasAllCharkeys","has","indexer","attr","items","has_value","push","indexById","isFunction","fn","AsyncFunction","Function","mapp","iterable","options","concurrency","results","runs","iterator","Symbol","sentinel","run","done","next","i","p","Promise","resolve","then","result","r","all","nonempty","now","Date","omitter","test","omit","isInteger","randomInt","delta","offset","Math","floor","random","rounder","decimals","op","round","multiplier","singleton","Class","instance","sleep","time_ms","setTimeout","upto","n","f","console","log","afn"],"mappings":"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"}